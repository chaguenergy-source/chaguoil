{% extends 'index.html' %}
{% load humanize %}
{% block page_content %}

<div class="head-title">
    <div class="left">
        
        {% include 'heading.html' %}
        <ul class="breadcrumb">
            <li>
                <a href="#">Dashboard</a>
            </li>
            <li>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
                    <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
            </li>
           

            <li>
                <a class="active" href="#"> {% if useri.langSet == 0 %}Mpango wa Zamu{% else %} Shifts Session{% endif %}</a>
            </li>             
        </ul>
    </div>
    


    {% if useri.admin %}
    <button data-toggle="modal" data-target="#addSessionModal" class="btn btn-default btn-download">
        <!-- <i class='bx bxs-cloud-download' ></i> -->
        <span class="text"> {% if useri.langSet == 0 %} Ongeza Mpango{% else %}Add Session{% endif %}</span>
    </button>
    {% endif %}

</div>


<div class="table-data">
    <div class="order">
        {% include 'headingShifts.html' %}     

      <div class="head">
        <h5 >

            <svg xmlns="http://www.w3.org/2000/svg" width="1.3em" height="1.3em" fill="currentColor" class="bi bi-alarm" viewBox="0 0 16 16">
                <path d="M8.5 5.5a.5.5 0 0 0-1 0v3.362l-1.429 2.38a.5.5 0 1 0 .858.515l1.5-2.5A.5.5 0 0 0 8.5 9V5.5z"/>
                <path d="M6.5 0a.5.5 0 0 0 0 1H7v1.07a7.001 7.001 0 0 0-3.273 12.474l-.602.602a.5.5 0 0 0 .707.708l.746-.746A6.97 6.97 0 0 0 8 16a6.97 6.97 0 0 0 3.422-.892l.746.746a.5.5 0 0 0 .707-.708l-.601-.602A7.001 7.001 0 0 0 9 2.07V1h.5a.5.5 0 0 0 0-1h-3zm1.038 3.018a6.093 6.093 0 0 1 .924 0 6 6 0 1 1-.924 0zM0 3.5c0 .753.333 1.429.86 1.887A8.035 8.035 0 0 1 4.387 1.86 2.5 2.5 0 0 0 0 3.5zM13.5 1c-.753 0-1.429.333-1.887.86a8.035 8.035 0 0 1 3.527 3.527A2.5 2.5 0 0 0 13.5 1z"/>
              </svg>
                {% if useri.langSet == 0 %}Mpango wa Zamu{% else %} Shifts Session {% endif %}</h5>
        
      </div>

      <div class="table-responsive">
            <table id="all_tanks" class="table-bordered smallFont"  >
                <thead>
                <tr class="text-center" >
                    <th>#</th>
                    {% if general %}
                        <th class="p-2">{% if useri.langSet == 0 %}Stesheni{% else %}station{% endif %} </th>
                    {% endif %}
                    <th class="p-2">{% if useri.langSet == 0 %}Jina{% else %}Session{% endif %} </th>
                   
                    <th class="p-2">{% if useri.langSet == 0 %}Kuanzia{% else %}From{% endif %} </th>
                     <th class="p-2">{% if useri.langSet == 0 %}Hadi{% else %}To{% endif %} </th>  
             
                    <th class="p-2">{% if useri.langSet == 0 %}Statasi{% else %}Status{% endif %} </th>
                    <!-- <th class="p-2">{% if useri.langSet == 0 %}Onesha{% else %}View{% endif %} </th> -->

                    
                  
                </tr>
                </thead>



                <tbody>
                    {% for s in shT %}
                        <tr  >
                            <td>{{forloop.counter}}</td>
                            {% if general %}
                             <td>{{s.Interprise.name}}</td>      
                            {% endif %}

                            <td>{{s.name}}</td>

                            <td>{{s.shFrom | date:"H:i"}}</td> 
                            <td>{{s.shTo | date:"H:i"}}</td>

                            <td>
                                {% if s.active %}
                                    Active
                                {% else %}    
                                     ---
                                {% endif %}
                            </td>

                            <!-- <td>
                                <a href="/salepurchase/viewShiftTime?i={{t.id}}" class="btn-light btn btn-sm" title="{% if useri.langSet == 0 %}Onesha{% else %}View{% endif %}" >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="1.3em" height="1.3em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                </a>
                            </td> -->

                            </tr>
                    {% endfor %}
                   
                </tbody>
            </table>
      </div>


     
    </div>
</div>



<!-- Modal -->
<div class="modal fade" id="addSessionModal" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    {% if useri.langSet == 0 %} Ongeza Mpango wa zamu{% else %}Add Shift's Session{% endif %}
                </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
            </div>
            <div class="modal-body">
                <form action="/salepurchase/addSession" id="addSessionForm" method="post">
                    <div class="form-group">
                      <label for="sessionName">
                        {% if useri.langSet == 0 %} Jina {% else %}Session Name{% endif %}
                      </label>
                      <input type="text"
                        class="form-control" name="sessionName" id="sessionName" aria-describedby="helpId" placeholder="">
                
                    </div>
                    <div class="form-group">
                      <label for="SesFrom">
                        {% if useri.langSet == 0 %} Muda wa Kuanza {% else %}Session Start{% endif %}
                      </label>
                      <input type="time"
                        class="form-control" name="SesFrom" id="SesFrom" aria-describedby="helpId" placeholder="">
                
                    </div>
                    <div class="form-group">
                      <label for="SesTo">
                        {% if useri.langSet == 0 %} Muda wa Kumaliza {% else %}Session End{% endif %}
                      </label>
                      <input type="time"
                        class="form-control" name="SesTo" id="SesTo" aria-describedby="helpId" placeholder="">
                
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>


{% endblock %}



{% block additionaljs %} 
<script>
      $(document).ready(function(){
      $('#all_tanks').DataTable();
  
    })

$('#addSessionForm').submit(function(e){
    e.preventDefault()
    const name = $('#sessionName').val(),
          sfrom =    $('#SesFrom').val(),
          sTo=    $('#SesTo').val(),
          url = $(this).attr('action')

          if(name!=''&&sfrom!=''&&sTo!=''){
              $('#addSessionModal').modal('hide')
              $('#loadMe').modal('show')
              const data = {
                data:{name,sfrom,sTo},
                url
              },
              sendIt = POSTREQUEST(data)
              sendIt.then(resp=>{
                $('#loadMe').modal('hide')
                hideLoading()
                 const msg = lang(resp.swa,resp.eng)
                 if(resp.success){
                    toastr.success(msg,lang('Imefanikiwa','Success'),2000)
                    location.reload()
                }else{
                    toastr.erro(msg,lang('Haikufanikiwa','Error'),2000)
                 }
              })
          }else{
            if(name=='')redborder('#sessionName')
            if(sfrom=='')redborder('#SesFrom')
            if(sTo=='')redborder('#SesTo')
          }
})

</script>
{% endblock %}

{% block shifts %} active {% endblock %}